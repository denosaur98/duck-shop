document.addEventListener("DOMContentLoaded",function(){const d=document.querySelectorAll(".navigation__item");let a=window.location.pathname;function L(){d.forEach(t=>{const n=new URL(t.href,window.location.origin).pathname;t.classList.remove("active"),t.classList.add("initial"),(n===a||a.startsWith(n)&&n!=="/")&&(t.classList.add("active"),t.classList.remove("initial"))})}d.forEach(t=>{t.addEventListener("click",function(n){n.preventDefault(),m();const e=new URL(t.href).pathname;e!==a&&(d.forEach(s=>{s.classList.remove("active"),s.classList.add("initial")}),t.classList.add("active"),t.classList.remove("initial"),history.pushState(null,"",t.href),a=e)})}),window.addEventListener("popstate",function(){a=window.location.pathname,L(),loadContent(a)});const p=document.querySelectorAll(".action__callback-button"),h=document.querySelector(".base-popup-wrapper"),y=document.querySelector(".popup-overlay"),b=document.querySelector(".form__close-button"),v=document.getElementById("name");p.forEach(t=>{t.addEventListener("click",function(){h.classList.add("active"),c.classList.contains("active")&&(i.style.transform="translateY(-100%)",setTimeout(()=>{c.classList.remove("active"),u.classList.remove("active"),i.style.transform=""},500))})});function f(){h.classList.remove("active"),p.forEach(t=>t.classList.remove("active")),l.value="",v.value=""}y.addEventListener("click",f),b.addEventListener("click",f);const l=document.getElementById("phone");l.addEventListener("input",E),l.addEventListener("keydown",S);function E(t){const n=t.target;let e=n.value.replace(/\D/g,""),s=n.selectionStart;e.length===1&&e!=="7"?e="79"+e:e==="7"?e="79":e.length>=2&&!e.startsWith("79")&&(e="79"+e.substring(1)),e.length>11&&(e=e.substring(0,11));const r=n.value.substring(0,s),k=Math.max(r.replace(/\D/g,"").length-2,0);let o=e.length>0?"+7 (9":"";e.length>2&&(o+=e.substring(2,4),e.length>4&&(o+=`) ${e.substring(4,7)}`,e.length>7&&(o+=`-${e.substring(7,9)}`,e.length>9&&(o+=`-${e.substring(9,11)}`)))),e.length>2&&e.length<=4&&(o+=")"),n.value=o;const g=w(o,k);n.setSelectionRange(g,g)}function S(t){if(t.key==="Backspace"){const n=t.target,e=n.selectionStart;if(e<=5){t.preventDefault();return}/\d/.test(n.value[e-1])||(t.preventDefault(),n.setSelectionRange(e-1,e-1))}}function w(t,n){let e=0,s=t.length;for(let r=5;r<t.length&&!(e>=n);r++)/\d/.test(t[r])&&e++,s=r+1;return Math.max(s,5)}document.querySelector(".form__submit-button").addEventListener("click",function(t){t.preventDefault();const n=l.value.replace(/\D/g,"");if(v.value.trim()===""){alert("Пожалуйста, введите ваше имя");return}if(l.value===""||n.length!==11){alert("Пожалуйста, введите корректный номер телефона");return}alert(`
      ${v.value}, ваша заявка на обратный звонок отправлена!
      Скоро мы свяжемся с вами по номеру: +${n}.
    `),f()});const u=document.querySelector(".action__burger-button"),c=document.querySelector(".base-menu-popup"),P=document.querySelector(".close-burger-menu"),_=document.querySelector(".menu-popup-overlay"),i=document.querySelector(".popup__content");u.addEventListener("click",function(){c.classList.contains("active")||(c.classList.add("active"),u.classList.add("active"))});function m(){i.style.transform="translateY(-100%)",setTimeout(()=>{c.classList.remove("active"),u.classList.remove("active"),i.style.transform=""},500)}P.addEventListener("click",m),_.addEventListener("click",m),i.addEventListener("transitionend",function(){c.classList.contains("active")||(i.style.transform="")})});
