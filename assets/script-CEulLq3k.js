document.addEventListener("DOMContentLoaded",function(){const d=document.querySelectorAll(".navigation__item");let c=window.location.pathname;function b(){d.forEach(e=>{const n=new URL(e.href,window.location.origin).pathname;e.classList.remove("active"),e.classList.add("initial"),(n===c||c.startsWith(n)&&n!=="/")&&(e.classList.add("active"),e.classList.remove("initial"))})}d.forEach(e=>{e.addEventListener("click",function(n){n.preventDefault(),m();const t=new URL(e.href).pathname;t!==c&&(d.forEach(o=>{o.classList.remove("active"),o.classList.add("initial")}),e.classList.add("active"),e.classList.remove("initial"),history.pushState(null,"",e.href),c=t)})}),window.addEventListener("popstate",function(){c=window.location.pathname,b(),loadContent(c)});const p=document.querySelector(".action__shop-button");p.addEventListener("click",function(){p.classList.toggle("active")});const h=document.querySelectorAll(".action__callback-button"),g=document.querySelector(".base-popup-wrapper"),E=document.querySelector(".popup-overlay"),S=document.querySelector(".form__close-button"),v=document.getElementById("name");h.forEach(e=>{e.addEventListener("click",function(){g.classList.add("active"),a.classList.contains("active")&&(i.style.transform="translateY(-100%)",setTimeout(()=>{a.classList.remove("active"),u.classList.remove("active"),i.style.transform=""},500))})});function f(){g.classList.remove("active"),h.forEach(e=>e.classList.remove("active")),l.value="",v.value=""}E.addEventListener("click",f),S.addEventListener("click",f);const L=document.querySelector(".action__show-button");L.addEventListener("click",function(){L.classList.toggle("active")});const l=document.getElementById("phone");l.addEventListener("input",w),l.addEventListener("keydown",_);function w(e){const n=e.target;let t=n.value.replace(/\D/g,""),o=n.selectionStart;t.length===1&&t!=="7"?t="79"+t:t==="7"?t="79":t.length>=2&&!t.startsWith("79")&&(t="79"+t.substring(1)),t.length>11&&(t=t.substring(0,11));const r=n.value.substring(0,o),B=Math.max(r.replace(/\D/g,"").length-2,0);let s=t.length>0?"+7 (9":"";t.length>2&&(s+=t.substring(2,4),t.length>4&&(s+=`) ${t.substring(4,7)}`,t.length>7&&(s+=`-${t.substring(7,9)}`,t.length>9&&(s+=`-${t.substring(9,11)}`)))),t.length>2&&t.length<=4&&(s+=")"),n.value=s;const y=P(s,B);n.setSelectionRange(y,y)}function _(e){if(e.key==="Backspace"){const n=e.target,t=n.selectionStart;if(t<=5){e.preventDefault();return}/\d/.test(n.value[t-1])||(e.preventDefault(),n.setSelectionRange(t-1,t-1))}}function P(e,n){let t=0,o=e.length;for(let r=5;r<e.length&&!(t>=n);r++)/\d/.test(e[r])&&t++,o=r+1;return Math.max(o,5)}document.querySelector(".form__submit-button").addEventListener("click",function(e){e.preventDefault();const n=l.value.replace(/\D/g,"");if(v.value.trim()===""){alert("Пожалуйста, введите ваше имя");return}if(l.value===""||n.length!==11){alert("Пожалуйста, введите корректный номер телефона");return}alert(`
      ${v.value}, ваша заявка на обратный звонок отправлена!
      Скоро мы свяжемся с вами по номеру: +${n}.
    `),f()});const u=document.querySelector(".action__burger-button"),a=document.querySelector(".base-menu-popup"),k=document.querySelector(".close-burger-menu"),q=document.querySelector(".menu-popup-overlay"),i=document.querySelector(".popup__content");u.addEventListener("click",function(){a.classList.contains("active")||(a.classList.add("active"),u.classList.add("active"))});function m(){i.style.transform="translateY(-100%)",setTimeout(()=>{a.classList.remove("active"),u.classList.remove("active"),i.style.transform=""},500)}k.addEventListener("click",m),q.addEventListener("click",m),i.addEventListener("transitionend",function(){a.classList.contains("active")||(i.style.transform="")})});
